{
  "batch_dim": 0,
  "batch_size": 7,
  "depth": -1,
  "basic_blocks": [
    "transformers.modeling_utils.Conv1D",
    "torch.nn.modules.normalization.LayerNorm",
    "torch.nn.modules.sparse.Embedding",
    "torch.nn.modules.dropout.Dropout"
  ],
  "model_inputs": ["input0"],
  "model_input_shapes": [[1, 1024]],
  "model_outputs": ["GPT2Model/LayerNorm[ln_f]"],
  "model_output_shapes": [[1, 1024, 1600]],
  "stages": {
    "0": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": ["input0"],
      "outputs": [
        "GPT2Model/Block[5]/MLP[mlp]/Dropout[dropout]",
        "GPT2Model/Block[5]/aten::add20441"
      ],
      "input_shapes": [[1, 1024]],
      "output_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition0",
      "devices": ["cpu"]
    },
    "1": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": [
        "GPT2Model/Block[5]/MLP[mlp]/Dropout[dropout]",
        "GPT2Model/Block[5]/aten::add20441"
      ],
      "outputs": ["GPT2Model/Block[12]/aten::add22471"],
      "input_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "output_shapes": [[1, 1024, 1600]],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition1",
      "devices": ["cpu"]
    },
    "2": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": ["GPT2Model/Block[12]/aten::add22471"],
      "outputs": ["GPT2Model/Block[18]/aten::add24211"],
      "input_shapes": [[1, 1024, 1600]],
      "output_shapes": [[1, 1024, 1600]],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition2",
      "devices": ["cpu"]
    },
    "3": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": ["GPT2Model/Block[18]/aten::add24211"],
      "outputs": [
        "GPT2Model/Block[23]/aten::add25737",
        "GPT2Model/Block[24]/Attention[attn]/Dropout[resid_dropout]"
      ],
      "input_shapes": [[1, 1024, 1600]],
      "output_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition3",
      "devices": ["cpu"]
    },
    "4": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": [
        "GPT2Model/Block[23]/aten::add25737",
        "GPT2Model/Block[24]/Attention[attn]/Dropout[resid_dropout]"
      ],
      "outputs": ["GPT2Model/Block[30]/aten::add27767"],
      "input_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "output_shapes": [[1, 1024, 1600]],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition4",
      "devices": ["cpu"]
    },
    "5": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": ["GPT2Model/Block[30]/aten::add27767"],
      "outputs": [
        "GPT2Model/Block[36]/aten::add29507",
        "GPT2Model/Block[37]/Attention[attn]/aten::matmul29667"
      ],
      "input_shapes": [[1, 1024, 1600]],
      "output_shapes": [
        [1, 1024, 1600],
        [1, 25, 1024, 64]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition5",
      "devices": ["cpu"]
    },
    "6": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": [
        "GPT2Model/Block[36]/aten::add29507",
        "GPT2Model/Block[37]/Attention[attn]/aten::matmul29667"
      ],
      "outputs": [
        "GPT2Model/Block[41]/aten::add30957",
        "GPT2Model/Block[42]/Attention[attn]/Conv1D[c_attn]"
      ],
      "input_shapes": [
        [1, 1024, 1600],
        [1, 25, 1024, 64]
      ],
      "output_shapes": [
        [1, 1024, 1600],
        [1, 1024, 4800]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition6",
      "devices": ["cpu"]
    },
    "7": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": [
        "GPT2Model/Block[41]/aten::add30957",
        "GPT2Model/Block[42]/Attention[attn]/Conv1D[c_attn]"
      ],
      "outputs": ["GPT2Model/LayerNorm[ln_f]"],
      "input_shapes": [
        [1, 1024, 1600],
        [1, 1024, 4800]
      ],
      "output_shapes": [[1, 1024, 1600]],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl_8p.Partition7",
      "devices": ["cpu"]
    }
  }
}
