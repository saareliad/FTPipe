{
  "batch_dim": 0,
  "batch_size": 2,
  "depth": -1,
  "basic_blocks": [
    "transformers.modeling_utils.Conv1D",
    "torch.nn.modules.normalization.LayerNorm",
    "torch.nn.modules.sparse.Embedding",
    "torch.nn.modules.dropout.Dropout"
  ],
  "model_inputs": ["input0"],
  "model_input_shapes": [[1, 1024]],
  "model_outputs": ["GPT2Model/LayerNorm[ln_f]"],
  "model_output_shapes": [[1, 1024, 768]],
  "stages": {
    "0": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": ["input0"],
      "outputs": [
        "GPT2Model/Block[0]/Attention[attn]/Dropout[resid_dropout]",
        "GPT2Model/Dropout[drop]"
      ],
      "input_shapes": [[1, 1024]],
      "output_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition0",
      "devices": ["cpu"]
    },
    "1": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": [
        "GPT2Model/Block[0]/Attention[attn]/Dropout[resid_dropout]",
        "GPT2Model/Dropout[drop]"
      ],
      "outputs": ["GPT2Model/Block[2]/aten::add5567"],
      "input_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "output_shapes": [[1, 1024, 768]],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition1",
      "devices": ["cpu"]
    },
    "2": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": ["GPT2Model/Block[2]/aten::add5567"],
      "outputs": ["GPT2Model/Block[4]/aten::add6147"],
      "input_shapes": [[1, 1024, 768]],
      "output_shapes": [[1, 1024, 768]],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition2",
      "devices": ["cpu"]
    },
    "3": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": ["GPT2Model/Block[4]/aten::add6147"],
      "outputs": [
        "GPT2Model/Block[5]/MLP[mlp]/Conv1D[c_proj]",
        "GPT2Model/Block[5]/aten::add6437"
      ],
      "input_shapes": [[1, 1024, 768]],
      "output_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition3",
      "devices": ["cpu"]
    },
    "4": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": [
        "GPT2Model/Block[5]/MLP[mlp]/Conv1D[c_proj]",
        "GPT2Model/Block[5]/aten::add6437"
      ],
      "outputs": [
        "GPT2Model/Block[7]/LayerNorm[ln_2]",
        "GPT2Model/Block[7]/aten::add7017"
      ],
      "input_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "output_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition4",
      "devices": ["cpu"]
    },
    "5": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": [
        "GPT2Model/Block[7]/LayerNorm[ln_2]",
        "GPT2Model/Block[7]/aten::add7017"
      ],
      "outputs": ["GPT2Model/Block[8]/aten::add7383"],
      "input_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "output_shapes": [[1, 1024, 768]],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition5",
      "devices": ["cpu"]
    },
    "6": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": ["GPT2Model/Block[8]/aten::add7383"],
      "outputs": [
        "GPT2Model/Block[9]/MLP[mlp]/Dropout[dropout]",
        "GPT2Model/Block[9]/aten::add7597"
      ],
      "input_shapes": [[1, 1024, 768]],
      "output_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition6",
      "devices": ["cpu"]
    },
    "7": {
      "batch_dim": 0,
      "batch_size": 2,
      "inputs": [
        "GPT2Model/Block[9]/MLP[mlp]/Dropout[dropout]",
        "GPT2Model/Block[9]/aten::add7597"
      ],
      "outputs": ["GPT2Model/LayerNorm[ln_f]"],
      "input_shapes": [
        [1, 1024, 768],
        [1, 1024, 768]
      ],
      "output_shapes": [[1, 1024, 768]],
      "stage_cls": "models.partitioned.gpt2.gpt2_small_8p.Partition7",
      "devices": ["cpu"]
    }
  }
}
