{
  "batch_dim": 0,
  "batch_size": 7,
  "depth": -1,
  "basic_blocks": [
    "torch.nn.modules.normalization.LayerNorm",
    "transformers.modeling_utils.Conv1D",
    "torch.nn.modules.sparse.Embedding",
    "torch.nn.modules.dropout.Dropout"
  ],
  "model_inputs": ["input0"],
  "model_input_shapes": [[1, 1024]],
  "model_outputs": ["GPT2Model/LayerNorm[ln_f]"],
  "model_output_shapes": [[1, 1024, 1600]],
  "stages": {
    "0": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": ["input0"],
      "outputs": [
        "GPT2Model/Block[11]/aten::add22257",
        "GPT2Model/Block[12]/LayerNorm[ln_1]"
      ],
      "input_shapes": [[1, 1024]],
      "output_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl.Partition0",
      "devices": ["cpu"]
    },
    "1": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": [
        "GPT2Model/Block[11]/aten::add22257",
        "GPT2Model/Block[12]/LayerNorm[ln_1]"
      ],
      "outputs": ["GPT2Model/Block[24]/aten::add25951"],
      "input_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "output_shapes": [[1, 1024, 1600]],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl.Partition1",
      "devices": ["cpu"]
    },
    "2": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": ["GPT2Model/Block[24]/aten::add25951"],
      "outputs": [
        "GPT2Model/Block[35]/MLP[mlp]/Dropout[dropout]",
        "GPT2Model/Block[35]/aten::add29141"
      ],
      "input_shapes": [[1, 1024, 1600]],
      "output_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl.Partition2",
      "devices": ["cpu"]
    },
    "3": {
      "batch_dim": 0,
      "batch_size": 7,
      "inputs": [
        "GPT2Model/Block[35]/MLP[mlp]/Dropout[dropout]",
        "GPT2Model/Block[35]/aten::add29141"
      ],
      "outputs": ["GPT2Model/LayerNorm[ln_f]"],
      "input_shapes": [
        [1, 1024, 1600],
        [1, 1024, 1600]
      ],
      "output_shapes": [[1, 1024, 1600]],
      "stage_cls": "models.partitioned.gpt2.gpt2_xl.Partition3",
      "devices": ["cpu"]
    }
  }
}
