{
  "batch_dim": 0,
  "depth": -1,
  "basic_blocks": [
    "torch.nn.modules.normalization.LayerNorm",
    "models.normal.NLP_models.stateless.StatelessEmbedding",
    "torch.nn.modules.dropout.Dropout",
    "torch.nn.modules.sparse.Embedding",
    "transformers.modeling_utils.Conv1D",
    "models.normal.NLP_models.stateless.StatelessLinear"
  ],
  "model_inputs": {
    "input0": {
      "shape": [2, 1024],
      "is_batched": true
    },
    "input1": {
      "shape": [2, 1024],
      "is_batched": true
    }
  },
  "model_outputs": {
    "GPT2LMHeadModel/aten::nll_loss4189": {
      "shape": [1],
      "is_batched": false
    }
  },
  "stages": {
    "0": {
      "batch_dim": 0,
      "inputs": {
        "input0": {
          "shape": [2, 1024],
          "is_batched": true
        }
      },
      "outputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[1]/MLP[mlp]/Conv1D[c_fc]": {
          "shape": [2, 1024, 3072],
          "is_batched": true
        },
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[1]/aten::add5366": {
          "shape": [2, 1024, 768],
          "is_batched": true
        },
        "GPT2LMHeadModel/Parameter[w_wte]": {
          "shape": [50257, 768],
          "is_batched": false
        }
      },
      "stage_cls": "models.partitioned.gpt2.Partition0",
      "devices": ["cpu"]
    },
    "1": {
      "batch_dim": 0,
      "inputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[1]/MLP[mlp]/Conv1D[c_fc]": {
          "shape": [2, 1024, 3072],
          "is_batched": true
        },
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[1]/aten::add5366": {
          "shape": [2, 1024, 768],
          "is_batched": true
        }
      },
      "outputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[4]/aten::add6312": {
          "shape": [2, 1024, 768],
          "is_batched": true
        },
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[5]/LayerNorm[ln_1]": {
          "shape": [2, 1024, 768],
          "is_batched": true
        }
      },
      "stage_cls": "models.partitioned.gpt2.Partition1",
      "devices": ["cpu"]
    },
    "2": {
      "batch_dim": 0,
      "inputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[4]/aten::add6312": {
          "shape": [2, 1024, 768],
          "is_batched": true
        },
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[5]/LayerNorm[ln_1]": {
          "shape": [2, 1024, 768],
          "is_batched": true
        }
      },
      "outputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[8]/LayerNorm[ln_2]": {
          "shape": [2, 1024, 768],
          "is_batched": true
        },
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[8]/aten::add7396": {
          "shape": [2, 1024, 768],
          "is_batched": true
        }
      },
      "stage_cls": "models.partitioned.gpt2.Partition2",
      "devices": ["cpu"]
    },
    "3": {
      "batch_dim": 0,
      "inputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[8]/LayerNorm[ln_2]": {
          "shape": [2, 1024, 768],
          "is_batched": true
        },
        "GPT2LMHeadModel/GPT2Model[transformer]/Block[8]/aten::add7396": {
          "shape": [2, 1024, 768],
          "is_batched": true
        }
      },
      "outputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/LayerNorm[ln_f]": {
          "shape": [2, 1024, 768],
          "is_batched": true
        }
      },
      "stage_cls": "models.partitioned.gpt2.Partition3",
      "devices": ["cpu"]
    },
    "4": {
      "batch_dim": 0,
      "inputs": {
        "GPT2LMHeadModel/GPT2Model[transformer]/LayerNorm[ln_f]": {
          "shape": [2, 1024, 768],
          "is_batched": true
        },
        "GPT2LMHeadModel/Parameter[w_wte]": {
          "shape": [50257, 768],
          "is_batched": false
        },
        "input1": {
          "shape": [2, 1024],
          "is_batched": true
        }
      },
      "outputs": {
        "GPT2LMHeadModel/aten::nll_loss4189": {
          "shape": [1],
          "is_batched": false
        }
      },
      "stage_cls": "models.partitioned.gpt2.Partition4",
      "devices": ["cpu"]
    }
  }
}
